[supervisord]
nodaemon=true
user=root
logfile=/tmp/supervisord.log
pidfile=/tmp/supervisord.pid

; Make sure the child processes see the right env
environment=USER="%(ENV_USER)s",HOME="/home/%(ENV_USER)s",VNC_PORT="%(ENV_VNC_PORT)s",NO_VNC_PORT="%(ENV_NO_VNC_PORT)s"

[program:vnc]
; Run from the userâ€™s home and execute via bash (avoids CRLF/shebang issues)
directory=/home/%(ENV_USER)s
command=/bin/bash -lc 'exec gosu %(ENV_USER)s /bin/bash /home/%(ENV_USER)s/.vnc/vnc_run.sh'
autostart=true
autorestart=true
stdout_logfile=/tmp/vnc.log
stderr_logfile=/tmp/vnc.err
startsecs=2

[program:novnc]
; Keep only if you actually use noVNC
command=/bin/bash -lc 'websockify --web=/usr/share/novnc %(ENV_NO_VNC_PORT)s localhost:%(ENV_VNC_PORT)s'
autostart=true
autorestart=true
stdout_logfile=/tmp/novnc.log
stderr_logfile=/tmp/novnc.err
startsecs=2
